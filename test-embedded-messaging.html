<!DOCTYPE html>
<html>
<head>
    <title>Test Chat</title>
<script type='text/javascript'>
    var user;
    window.addEventListener('userInfo', function(e){
        user = e.detail;   
    });
    window.addEventListener("onEmbeddedMessagingReady", e => {
        embeddedservice_bootstrap.prechatAPI.setVisiblePrechatFields({
            //"_firstName": {
            //    "value": user.firstName,
            //    "isEditableByEndUser": false
            //},
            //"_lastName": {
            //    "value": user.lastName,
            //    "isEditableByEndUser": false
            //},
            "_subject": {
                "value": user.email,
                "isEditableByEndUser": false
            }
        });
    });
</script>    
    
</head>
<body>
    <h1>Test Chat Page</h1>
    <script type='text/javascript'>
        function initEmbeddedMessaging() {
            try {
                embeddedservice_bootstrap.settings.language = 'en_US'; // Set the language

//                window.addEventListener("onEmbeddedMessagingReady", e=> {
//                    embeddedservice_bootstrap.prechatAPI.setVisiblePrechatFields({
                        //"Product": {
                          //  "value": "Prod1",
                        //    "isEditableByEndUser": true
                        //},
//                        "_subject": {
//                            "value": "Testing",
//                            "isEditableByEndUser": true
                        //},
                        //"Brand": {
                        //    // "value": "Brand1",
                        //    "isEditableByEndUser": true
//                        }
                    //});
                //});

                embeddedservice_bootstrap.init(
                    '00DDV000000tcBY', // Replace with your Deployment ID
                    'Xenial_Support_Chat', // Replace with your Button ID
                    'https://sicom--chat.sandbox.my.site.com/ESWXenialSupportChat1738258564026', // Replace with your Embedded Service URL
                    {
                        scrt2URL: 'https://sicom--chat.sandbox.my.salesforce-scrt.com', // Replace with your Secure Token URL
//                        prechatEnabled: true, // Ensure pre-chat is enabled
//                        extraPrechatInfo:  // embeddedservice_bootstrap.settings.extraPrechatInfo Add pre-chat fields
//                [
//                    {
//                        "label": "Product", // Label displayed to the user
//                        "transcriptFields": ["Product"], // API Name in Salesforce
//                        "displayToAgent": true
//                    },
//                    {
//                        "label": "Brand", // Label displayed to the user
//                        "transcriptFields": ["Brand"], // API Name in Salesforce
//                        "displayToAgent": true
//                    }
//                ]
                    }
                );
            } catch (err) {
                console.error('Error loading Embedded Messaging: ', err);
            }
        }
    </script>
    <script type='text/javascript' src='https://sicom--chat.sandbox.my.site.com/ESWXenialSupportChat1738258564026/assets/js/bootstrap.min.js' onload='initEmbeddedMessaging()'></script>
</body>
</html>
